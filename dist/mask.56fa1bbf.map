{"version":3,"sources":["scripts/mask.js"],"names":["$","fn","getCursorPosition","input","get","selectionStart","document","selection","focus","sel","createRange","selLen","text","length","moveStart","value","setCursorPosition","pos","setSelectionRange","createTextRange","range","collapse","moveEnd","select","delSelected","val","start","end","selectionEnd","substr","substring","phoneFormat","phoneFormatted","element","newVal","String","replace","newVall","res","i","charAt","keydown","event","cursor","code","keyCode","startValue","ctrlKey","metaKey","shiftKey","altKey","delCount","key","preventDefault","jQuery","ready"],"mappings":"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","file":"mask.56fa1bbf.map","sourceRoot":"..","sourcesContent":["// import $ from 'jquery';\n\n// function clearVal(val,limit) {\n//   var newVal = val.replace(/[^\\d]+/g, '');\n//     return newVal.substring(0, limit);\n// };\n\n// function getMask(newVal) {\n//   var res = '';\n//   for (var i = 0; i < newVal.length; i++) {\n//    if (i == 0) {\n//       res += ' '+'(';\n//       res += newVal.charAt(i);\n//     } else if (i == 3) {\n//       res += ')' + ' ';\n//       res += newVal.charAt(i);\n//     } else if (i == 6 || i == 8 ) {\n//       res += '-';\n//       res += newVal.charAt(i);\n//     } else {\n//       res += newVal.charAt(i);\n//     }\n//   }\n//   return res;\n// };\n\n// $(function(){\n//   $('#phone').on('input', function(){\n//     var val = $(this).val(),\n//         limit = 10;\n//     var newVal = clearVal(val, limit);\n//     var res = getMask(newVal);\n//     $(this).val(res);\n  \n//     if (newVal.length == limit) {\n//       document.getElementById('button').disabled = false;\n//     } else {\n//       document.getElementById('button').disabled = true;\n//     }\n//   }); \n//   // document.getElementById('phone').addEventListener('keyup', e => {\n//   //   console.log('Caret at: ', e.target.selectionStart)\n//   // })\n// });\n\n\n\n\n// W O R K  C O D E\n\n(function ($) {\n  \n  // узнать позицию курсора\n  $.fn.getCursorPosition = function () {\n      var input = this.get(0);\n      if (!input) return;\n      if ('selectionStart' in input) {\n          return input.selectionStart;\n      } else if (document.selection) {\n          input.focus();\n          var sel = document.selection.createRange();\n          var selLen = document.selection.createRange().text.length;\n          sel.moveStart('character', -input.value.length);\n          return sel.text.length - selLen;\n      }\n  }\n  // установить позицию курсора\n  $.fn.setCursorPosition = function (pos) {\n      if ($(this).get(0).setSelectionRange) {\n          $(this).get(0).setSelectionRange(pos, pos);\n      } else if ($(this).get(0).createTextRange) {\n          var range = $(this).get(0).createTextRange();\n          range.collapse(true);\n          range.moveEnd('character', pos);\n          range.moveStart('character', pos);\n          range.select();\n      }\n  }\n  // удалить выделенный текст\n  $.fn.delSelected = function () {\n      var input = $(this);\n      var value = input.val();\n      var start = input[0].selectionStart;\n      var end = input[0].selectionEnd;\n      input.val(\n              value.substr(0, start) + value.substring(end, value.length)\n      );\n      return end - start;\n  };\n\n  $.fn.phoneFormat = function () {\n\n      function phoneFormatted(element) {\n        var newVal = String(element).replace(/[^\\d]/g, '');\n        var newVall = newVal.substring(0, 10);\n        if(!element) return '';\n        var res = '';\n        for (var i = 0; i < newVall.length; i++) {\n          if (i == 0) {\n              res += ' '+'(';\n              res += newVall.charAt(i);\n              } else if (i == 3) {\n              res += ')' + ' ';\n              res += newVall.charAt(i);\n              } else if (i == 6 || i == 8 ) {\n              res += '-';\n              res += newVall.charAt(i);\n              } else {\n              res += newVall.charAt(i);\n              }\n          }\n          return res;\n      }\n\n      $(this)\n              .keydown(function (event) {\n                  var cursor = $(this).getCursorPosition();\n                  var code = event.keyCode;\n                  var startValue = $(this).val();\n                  \n                  if ((event.ctrlKey === true && code == 86) || // Ctrl+V | Shift+insert\n                      (event.metaKey === true && code == 86) || \n                          (event.shiftKey === true && code == 45)) {\n                      return false;\n                  } else if (\n                          code == 9 || // tab\n                                  code == 27 || // ecs\n                                  event.ctrlKey === true || // все что вместе с ctrl\n                                  event.metaKey === true ||\n                                  event.altKey === true || // все что вместе с alt\n                                  event.shiftKey === true || // все что вместе с shift\n                                  (code >= 112 && code <= 123) || // F1 - F12\n                                  (code >= 35 && code <= 39)) // end, home, стрелки\n                  {\n                      return;\n\n                  } else if (code == 8) {// backspace\n\n                      var delCount = $(this).delSelected();\n                      if (!delCount) {\n                          if (startValue[cursor - 1] === ' ') {\n                              cursor--;\n                          }\n                          $(this).val(startValue.substr(0, cursor - 1) + startValue.substring(cursor, startValue.length));\n                      }\n                      $(this).val(phoneFormatted($(this).val()));\n                      $(this).setCursorPosition(cursor - (startValue.length - $(this).val().length - delCount));\n\n                    \n                      if (cursor == 7){\n                        $(this).setCursorPosition(cursor + 2 - (startValue.length - $(this).val().length - delCount));\n                      }\n                      if (cursor == 9) {\n                        $(this).setCursorPosition(cursor + 1 - (startValue.length - $(this).val().length - delCount));\n                      }\n                      if ((cursor == 14) || (cursor == 6)){\n                        $(this).setCursorPosition(cursor - 1 - (startValue.length - $(this).val().length - delCount));\n                      }\n\n                  } else if (code == 46) { // delete\n\n                      var delCount = $(this).delSelected();\n                      if (!delCount) {\n                          if (startValue[cursor] === ' ') {\n                              cursor++;\n                          }\n                          $(this).val(startValue.substr(0, cursor) + startValue.substring(cursor + 1, startValue.length));\n                      }\n                      if (!delCount)delCount = 1;\n                      $(this).val(phoneFormatted($(this).val()));\n                      $(this).setCursorPosition(cursor - (startValue.length - $(this).val().length - delCount));\n\n                  } else {\n                      $(this).delSelected();\n                      startValue = $(this).val();\n                      var key = false;\n                      // цифровые клавиши\n                      if ((code >= 48 && code <= 57)) {\n                          key = (code - 48);\n                      }\n                      // numpad\n                      else if ((code >= 96 && code <= 105 )) {\n                          key = (code - 96);\n                      } else {\n                          $(this).val(phoneFormatted($(this).val()));\n                          $(this).setCursorPosition(cursor);\n                          return false;\n                      }\n                      var length = startValue.length\n                      var value = startValue.substr(0, cursor) + key + startValue.substring(cursor, length);\n                      $(this).val(phoneFormatted(value));\n                      $(this).setCursorPosition(cursor + $(this).val().length - length);\n                \n                      if ((cursor == 15) || (cursor == 14) || (cursor == 12) || (cursor == 9)) {\n                        $(this).setCursorPosition(cursor + 1 + $(this).val().length - length);\n                      }\n                      if ((length > 8) && (cursor == 8)) {\n                         $(this).setCursorPosition(cursor - 1 + $(this).val().length - length);\n                      }\n                      if (cursor == 4 ) {\n                        $(this).setCursorPosition(cursor + 2 + $(this).val().length - length);\n                    }\n                  }\n                  event.preventDefault();\n              });\n  };\n})(jQuery);\n\n$(document).ready(function () {\n  $('#phone').phoneFormat();\n});\n\n"]}